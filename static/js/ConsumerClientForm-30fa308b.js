import{m as H,p as se,q as re,r as ie,I as _e,h as de,i as pe,s as fe,j as me,D as ve,t as ce,B as be,R as ge,u as ke,F as ye}from"./ant-design-vue-69c5e787.js";import{e as Me,l as p,K as Ue,r as b,s as L,X as z,a0 as he,c as e,Z as a,F as Ye,u as Ce,E as g,a6 as De,Y as xe,B as A,a7 as we,a1 as R}from"./@vue-0057e33b.js";import{a as Re,u as Fe}from"./vue-router-2c461628.js";import{s as Oe}from"./pinia-75b29db1.js";import{u as Te}from"./store-b4c7e3e8.js";import{a as K}from"./index-a7c45ba7.js";import{C as X,P as Z}from"./ProductDetailTable-002d87ee.js";import{d as U}from"./dayjs-d2af4db4.js";import{H as G}from"./@ant-design-c5cfb3ae.js";import"./@babel-f2deaedd.js";import"./lodash-es-c37e40cf.js";import"./resize-observer-polyfill-2974a3e4.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-7942c886.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./@ctrl-eebb6dbe.js";import"./dom-align-529d0cdc.js";import"./nprogress-8c52ea9a.js";import"./axios-cd074bab.js";import"./form-data-d2a9677b.js";const qe=R("h3",{class:"form-title"},"基本信息",-1),Be=R("h3",{class:"form-title"},"客户归属",-1),Se=R("h3",{class:"form-title"},"融资融券",-1),na={__name:"ConsumerClientForm",setup(je,{expose:J}){const F=Me("$http"),h=Re(),Q=Fe();function O(){Q.back()}const m=p("add"),W=Te(),{grkhForm:T}=Oe(W);Ue(()=>{h.query&&(m.value=h.query.type,h.query.type==="edit"?ee():Y())});const Y=()=>{C.value.resetFields(),d.value=[],_.value=[]},ee=()=>{Object.keys(T.value).filter(r=>r!=="updated_at"&&r!=="created_at").forEach(r=>{const t=T.value[r];switch(r){case"permissions":Object.keys(t).forEach(c=>{t[c]&&_.value.push(c)});break;case"interest_rate_effective_date":d.value[0]=U(t,f);break;case"interest_rate_expiry_date":d.value[1]=U(t,f);break;default:l[r]=t;break}})},C=p(),l=b({customer_type:0}),k=p(null);function q(){k.value.openModal(l.id)}function D(){k.value.closeModal()}function B(){D()}const y=p(null);function S(){y.value.openModal(l.id)}function x(){y.value.closeModal()}function j(){x()}const P=b([{label:"男",value:0},{label:"女",value:1}]),E=b([{label:"保守型",value:"保守型"},{label:"稳健型",value:"稳健型"},{label:"平衡型",value:"平衡型"},{label:"积极型",value:"积极型"},{label:"激进型",value:"激进型"}]),$=b([{label:"是",value:1},{label:"否",value:0}]),_=p([]),N=b([{label:"现金宝",value:"cash_treasure"},{label:"基金定投",value:"automatic_investment_plan"},{label:"双创板",value:"double_innovation_board"},{label:"期权",value:"share_option"},{label:"深港通",value:"shenzhen_hong_kong_stock_connect"},{label:"沪港通",value:"shanghai_hong_kong_stock_connect"},{label:"两融账户",value:"double_margin_account"},{label:"北交所",value:"beijing_stock_exchange"}]);L(()=>{if(_.value&&_.value.length){const r={};_.value.forEach(t=>{r[t]=!0}),l.permissions=r}});const d=p([]),f="YYYY-MM-DD";L(()=>{d.value&&(l.interest_rate_effective_date=U(d.value[0]).format(f),l.interest_rate_expiry_date=U(d.value[1]).format(f))});const v=p(!1),V=()=>{v.value=!0,m.value==="add"?F.post(K.customersList,{...l}).then(r=>{r.code===0&&(H.success("新增成功"),Y())}).finally(()=>{v.value=!1}):F.put(`${K.customersList}/${l.id}`,{...l}).then(r=>{r.code===0&&H.success("编辑成功")}).finally(()=>{v.value=!1})};return J({HomeOutlined:G,operateType:m,formRef:C,formState:l,risk_appetite_options:E,dateFormat:f,permissions:_,is_internet_channel_options:$,isSubmiting:v,genderOptions:P,permissionOptions:N,ContactDetailTable:X,ProductDetailTable:Z,contactRef:k,fundsRef:y,back:O,onFinish:V,handleContactDetailShow:q,handleContactTableOk:B,handleContactTableCancel:D,handleProductTableShow:S,handleProductTableCancel:x,handleProductTableOk:j}),(r,t)=>{const c=ie,ae=se,s=_e,o=de,u=pe,w=fe,i=me,I=ve,te=ce,M=be,le=ge,ne=ke,ue=ye,oe=re;return z(),he(Ye,null,[e(ae,null,{default:a(()=>[e(c,{onClick:O},{default:a(()=>[e(Ce(G))]),_:1}),e(c,null,{default:a(()=>[g("个人客户"+De(m.value==="add"?"新增":"编辑"),1)]),_:1})]),_:1}),e(oe,{spinning:v.value,tip:"正在提交..."},{default:a(()=>[e(ue,{ref_key:"formRef",ref:C,name:"advanced_search",class:"ant-advanced-search-form",model:l,onFinish:V},{default:a(()=>[qe,e(i,{gutter:24},{default:a(()=>[e(u,{span:6},{default:a(()=>[e(o,{name:"name",label:"姓  名",rules:[{required:!0,message:"请输入姓名"}]},{default:a(()=>[e(s,{value:l.name,"onUpdate:value":t[0]||(t[0]=n=>l.name=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"gender",label:"性  别",rules:[{required:!0,message:"请选择性别"}]},{default:a(()=>[e(w,{value:l.gender,"onUpdate:value":t[1]||(t[1]=n=>l.gender=n),options:P},null,8,["value","options"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"occupation",label:"职  业",rules:[{required:!0,message:"请输入职业"}]},{default:a(()=>[e(s,{value:l.occupation,"onUpdate:value":t[2]||(t[2]=n=>l.occupation=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"phone",label:"联系方式",rules:[{required:!0,message:"请输入联系方式"}]},{default:a(()=>[e(s,{value:l.phone,"onUpdate:value":t[3]||(t[3]=n=>l.phone=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:6},{default:a(()=>[e(o,{name:"capital_account",label:"资金账号",rules:[{required:!0,message:"请输入资金账号"}]},{default:a(()=>[e(s,{value:l.capital_account,"onUpdate:value":t[4]||(t[4]=n=>l.capital_account=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"birthday",label:"出生日期"},{default:a(()=>[e(I,{value:l.birthday,"onUpdate:value":t[5]||(t[5]=n=>l.birthday=n),placeholder:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"certificate_type",label:"证件类型"},{default:a(()=>[e(s,{value:l.certificate_type,"onUpdate:value":t[6]||(t[6]=n=>l.certificate_type=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"certificate_number",label:"证件号码"},{default:a(()=>[e(s,{value:l.certificate_number,"onUpdate:value":t[7]||(t[7]=n=>l.certificate_number=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:6},{default:a(()=>[e(o,{name:"existing_assets",label:"现有资产"},{default:a(()=>[e(s,{value:l.existing_assets,"onUpdate:value":t[8]||(t[8]=n=>l.existing_assets=n),valueModifiers:{number:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"historical_peak",label:"历史峰值"},{default:a(()=>[e(s,{value:l.historical_peak,"onUpdate:value":t[9]||(t[9]=n=>l.historical_peak=n),valueModifiers:{number:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"customer_source",label:"客户来源"},{default:a(()=>[e(s,{value:l.customer_source,"onUpdate:value":t[10]||(t[10]=n=>l.customer_source=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{name:"specific_channel",label:"具体渠道"},{default:a(()=>[e(s,{value:l.specific_channel,"onUpdate:value":t[11]||(t[11]=n=>l.specific_channel=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:6},{default:a(()=>[e(o,{name:"commission_rate",label:"佣金费率"},{default:a(()=>[e(s,{value:l.commission_rate,"onUpdate:value":t[12]||(t[12]=n=>l.commission_rate=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(o,{name:"risk_appetite",label:"风险偏好"},{default:a(()=>[e(w,{value:l.risk_appetite,"onUpdate:value":t[13]||(t[13]=n=>l.risk_appetite=n),options:E},null,8,["value","options"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"权限情况"},{default:a(()=>[e(te,{value:_.value,"onUpdate:value":t[14]||(t[14]=n=>_.value=n),options:N},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),m.value!=="add"?(z(),xe(i,{key:0,gutter:24},{default:a(()=>[e(u,{span:6},{default:a(()=>[e(o,{label:"联系情况"},{default:a(()=>[e(M,{href:"#",type:"link",onClick:A(q,["prevent"])},{default:a(()=>[g("详情")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(u,{span:6},{default:a(()=>[e(o,{label:"基金理财/私募"},{default:a(()=>[e(M,{type:"link",onClick:A(S,["prevent"])},{default:a(()=>[g("详情")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})):we("",!0),Be,e(i,{gutter:24},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(o,{name:"developer",label:" 开发关系"},{default:a(()=>[e(s,{value:l.developer,"onUpdate:value":t[15]||(t[15]=n=>l.developer=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{name:"is_internet_channel",label:"是否是互联网渠道"},{default:a(()=>[e(w,{value:l.is_internet_channel,"onUpdate:value":t[16]||(t[16]=n=>l.is_internet_channel=n),options:$},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(o,{name:"assignmenter",label:"服务包分配"},{default:a(()=>[e(s,{value:l.assignmenter,"onUpdate:value":t[17]||(t[17]=n=>l.assignmenter=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{name:"follower",label:"跟进情况"},{default:a(()=>[e(s,{value:l.follower,"onUpdate:value":t[18]||(t[18]=n=>l.follower=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1})]),_:1}),Se,e(i,{gutter:24},{default:a(()=>[e(u,{span:8},{default:a(()=>[e(o,{name:"account_opening_date",label:"开户日期"},{default:a(()=>[e(I,{value:l.account_opening_date,"onUpdate:value":t[19]||(t[19]=n=>l.account_opening_date=n),placeholder:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:8},{default:a(()=>[e(o,{name:"preferential_interest_rate",label:"优惠利率"},{default:a(()=>[e(s,{value:l.preferential_interest_rate,"onUpdate:value":t[20]||(t[20]=n=>l.preferential_interest_rate=n),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:8},{default:a(()=>[e(o,{name:"dateRange",label:"时  间"},{default:a(()=>[e(le,{value:d.value,"onUpdate:value":t[21]||(t[21]=n=>d.value=n),format:f},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:24},{default:a(()=>[e(o,{name:"remark",label:"备  注"},{default:a(()=>[e(ne,{value:l.remark,"onUpdate:value":t[22]||(t[22]=n=>l.remark=n),"show-count":"",maxlength:100},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,{gutter:24},{default:a(()=>[e(u,{span:24,style:{"text-align":"center"}},{default:a(()=>[e(M,{type:"primary","html-type":"submit"},{default:a(()=>[g("提交")]),_:1}),e(M,{style:{margin:"0 8px"},onClick:Y},{default:a(()=>[g(" 重置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"]),e(X,{ref_key:"contactRef",ref:k,onCancel:D,onOk:B},null,512),e(Z,{ref_key:"fundsRef",ref:y,onCancel:x,onOk:j},null,512)],64)}}};export{na as default};
