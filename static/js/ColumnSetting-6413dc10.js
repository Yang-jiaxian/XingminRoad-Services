import{m as E,l as D,o as U,p as J,B as F,q as T}from"./ant-design-vue-a65eb274.js";import{d as b}from"./vuedraggable-bd7afe23.js";import{_ as $}from"./index-4cbe4d0c.js";import{H as I,J as O}from"./@ant-design-b54d9c65.js";import{l as r,s as q,w as z,aL as H,an as j,c as s,b8 as u,E as d,ac as f,u as h,ao as p,F as G}from"./@vue-e16f66a9.js";const K={style:{float:"right"}},M={class:"move"},P={class:"drawer-footer"},Q={__name:"ColumnSetting",props:{allColumnList:{type:Array,default:()=>[]},currentColumns:{type:Array,default:()=>[]},settingName:{type:String,default:"column_setting"}},emits:["columnChanged","columnOrderChanged"],setup(N,{expose:V,emit:v}){const l=N,C=r("列设置"),i=r(!1),x=()=>{i.value=!0},o=r([]),a=r([]);q(()=>{o.value=l.allColumnList.filter(e=>e.dataIndex!=="action"),a.value=l.currentColumns.filter(e=>e.dataIndex!=="action").map(e=>e.dataIndex)});const k=()=>{const e=[...o.value,l.allColumnList[l.allColumnList.length-1]];v("columnOrderChanged",e);const t=[...o.value.filter(c=>a.value.includes(c.dataIndex)),l.allColumnList[l.allColumnList.length-1]];v("columnChanged",t)},m=r(!1),g=r(!0),y=e=>{e.target.checked?(a.value=o.value.map(t=>t.dataIndex),_(a.value)):(a.value=[],_([])),g.value=!1};z(()=>a.value,e=>{g.value=!!e.length&&e.length<o.value.length,m.value=e.length===o.value.length});const _=e=>{const t=[...l.allColumnList.filter(c=>e.includes(c.dataIndex)),l.allColumnList[l.allColumnList.length-1]];v("columnChanged",t)},S=()=>{const e=[...a.value,"action"],t=[...o.value,l.allColumnList[l.allColumnList.length-1]];localStorage.setItem(l.settingName,JSON.stringify(e)),localStorage.setItem(`${l.settingName}Order`,JSON.stringify(t)),E.success("保存成功"),i.value=!1};return V({SettingOutlined:I,DragOutlined:O,compTitle:C,draggable:b,drawerVisible:i,allColumns:o,checkedList:a,checkAll:m,indeterminate:g,handleShowDrawer:x,onCheckAllChange:y,handleSaveSetting:S,handleColumnChange:_,onDragColumnEnd:k}),(e,t)=>{const c=D,w=U,A=J,L=F,B=T;return H(),j(G,null,[s(c,null,{title:u(()=>[d(f(C.value),1)]),default:u(()=>[s(h(I),{style:{color:"var(--theme-color)"},onClick:x})]),_:1}),s(B,{visible:i.value,"onUpdate:visible":t[4]||(t[4]=n=>i.value=n),title:C.value,placement:"right"},{footer:u(()=>[p("div",P,[s(L,{onClick:t[3]||(t[3]=n=>i.value=!1)},{default:u(()=>[d("取消")]),_:1}),s(L,{style:{"margin-left":"10px"},type:"primary",onClick:S},{default:u(()=>[d("保存")]),_:1})])]),default:u(()=>[p("div",null,[s(w,{checked:m.value,"onUpdate:checked":t[0]||(t[0]=n=>m.value=n),indeterminate:g.value,onChange:y},{default:u(()=>[d(" 全选 ")]),_:1},8,["checked","indeterminate"]),p("span",K,"已选择 "+f(a.value.length)+" 个 ",1)]),s(A,{class:"checkbox-group",value:a.value,"onUpdate:value":t[2]||(t[2]=n=>a.value=n),onChange:_},{default:u(()=>[s(h(b),{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value=n),"item-key":n=>n.dataIndex,handle:".move",animation:"300",onEnd:k},{item:u(({element:n})=>[p("li",M,[s(h(O),{style:{"font-size":"16px","margin-right":"10px"}}),s(w,{value:n.dataIndex},{default:u(()=>[d(f(n.title),1)]),_:2},1032,["value"])])]),_:1},8,["modelValue","item-key"])]),_:1},8,["value"])]),_:1},8,["visible","title"])],64)}}},ee=$(Q,[["__scopeId","data-v-aa1e4c08"]]);export{ee as C};
