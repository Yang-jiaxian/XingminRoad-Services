import{m as oe,c as ye,A as xe,B as Ue,r as Me,s as Ye,I as De,f as Re,g as qe,t as Fe,D as Se,u as je,p as Pe,h as Ie,R as $e,v as ze,F as Ae}from"./ant-design-vue-a65eb274.js";import{a as Oe,u as Te}from"./vue-router-c7505a30.js";import{u as Be}from"./store-7a36e7d0.js";import{_ as Ee,a as L}from"./index-4cbe4d0c.js";import{C as ne,P as ue}from"./ProductDetailTable-46627c71.js";import{d as I}from"./dayjs-7e8bcc51.js";import{K as Le,N}from"./@ant-design-b54d9c65.js";import{e as Ne,l as p,K as Ve,r as Y,s as se,aL as V,an as K,ao as _,c as e,b8 as a,E as $,ac as Ke,F as re,am as ie,aa as r,aA as i,u as pe,aN as We,aM as Ge}from"./@vue-e16f66a9.js";import"./@babel-5c3af8a7.js";import"./resize-observer-polyfill-2974a3e4.js";import"./lodash-es-26de6f87.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-7942c886.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./@ctrl-eebb6dbe.js";import"./dom-align-529d0cdc.js";import"./pinia-9fcab373.js";import"./nprogress-733e006c.js";import"./axios-cd074bab.js";import"./form-data-d2a9677b.js";const k=D=>(We("data-v-cbbcce4e"),D=D(),Ge(),D),He={class:"container"},Je={class:"slider"},Qe={class:"content-wrap"},Xe=k(()=>_("div",{class:"form-header",id:"jbxx"},"基本资料",-1)),Ze=k(()=>_("h3",{class:"form-title"},"基本信息",-1)),ea={class:"form-title",id:"lxqk"},aa=k(()=>_("p",null,"联系情况",-1)),la=k(()=>_("span",null,"添加联系情况",-1)),ta={class:"form-title",id:"jjsm"},oa=k(()=>_("p",null,"基金理财/私募",-1)),na=k(()=>_("span",null,"添加添加理财/私募产品",-1)),ua=k(()=>_("h3",{class:"form-title",id:"khgs"},"客户归属",-1)),sa=k(()=>_("h3",{class:"form-title",id:"rzrq"},"融资融券",-1)),ra={__name:"ConsumerClientForm",setup(D,{expose:_e}){const z=Ne("$http"),w=Oe(),de=Te();function R(){de.back()}const y=p("add"),fe=Be(),q=p(null);Ve(()=>{w.query&&(y.value=w.query.type,w.query.type==="edit"?(l.id=w.query.id,ce(w.query.id)):A())});const ce=s=>{z.get(`${L.customersList}/${s}`).then(t=>{t.code===0&&(q.value=t.data,S.value.fetchTableData(),j.value.fetchTableData())}).catch(()=>{q.value=fe.grkhForm}).finally(()=>{ve()})},A=()=>{F.value.resetFields();for(const s in l)Object.hasOwnProperty.call(l,s)&&s!=="customer_type"&&delete l[s];v.value=[],h.value=[]},ve=()=>{Object.keys(q.value).filter(s=>s!=="updated_at"&&s!=="created_at").forEach(s=>{const t=q.value[s];switch(s){case"cash_treasure":case"automatic_investment_plan":case"double_innovation_board":case"share_option":case"shenzhen_hong_kong_stock_connect":case"shanghai_hong_kong_stock_connect":case"double_margin_account":case"beijing_stock_exchange":case"pension_account":t&&h.value.push(s);break;case"interest_rate_effective_date":t&&(v.value[0]=I(t,x));break;case"interest_rate_expiry_date":t&&(v.value[1]=I(t,x));break;default:l[s]=t;break}})},F=p(),c=p({xs:8,sm:16,md:24,lg:32}),W=p({lg:{span:6,offset:0},xl:{span:6,offset:0}}),G=p({lg:{span:18,offset:0},xl:{span:18,offset:0}}),d=p({lg:12,xl:8}),O=p({lg:{span:4,offset:0},xl:{span:2,offset:0}}),T=p({lg:{span:20,offset:0},xl:{span:22,offset:0}}),g=p({lg:{span:5,offset:0},xl:{span:4,offset:0}}),C=p({lg:{span:19,offset:0},xl:{span:20,offset:0}}),m=p({lg:24,xl:12}),l=Y({customer_type:0}),S=p(null);function H(){S.value.handleAdd()}const j=p(null);function J(){j.value.handleAdd()}const Q=Y([{label:"男",value:0},{label:"女",value:1}]),X=Y([{label:"保守型",value:"保守型"},{label:"稳健型",value:"稳健型"},{label:"平衡型",value:"平衡型"},{label:"积极型",value:"积极型"},{label:"激进型",value:"激进型"}]),Z=Y([{label:"是",value:1},{label:"否",value:0}]),h=p([]),ee=Y([{label:"现金宝",value:"cash_treasure"},{label:"基金定投",value:"automatic_investment_plan"},{label:"双创板",value:"double_innovation_board"},{label:"期权",value:"share_option"},{label:"深港通",value:"shenzhen_hong_kong_stock_connect"},{label:"沪港通",value:"shanghai_hong_kong_stock_connect"},{label:"两融账户",value:"double_margin_account"},{label:"北交所",value:"beijing_stock_exchange"},{label:"养老金帐户",value:"pension_account"}]);se(()=>{h.value&&h.value.length&&h.value.forEach(s=>{l[s]=!0})});const v=p([]),x="YYYY-MM-DD";se(()=>{v.value&&(v.value[0]&&(l.interest_rate_effective_date=I(v.value[0]).format(x)),v.value[1]&&(l.interest_rate_expiry_date=I(v.value[1]).format(x)))});const U=p(!1),ae=()=>{F.value.validate().then(()=>{U.value=!0,y.value==="add"?z.post(L.customersList,{...l}).then(s=>{s.code===0&&(oe.success("新增成功"),A(),R())}).finally(()=>{U.value=!1}):z.put(`${L.customersList}/${w.query.id}`,{...l}).then(s=>{s.code===0&&(oe.success("编辑成功"),R())}).finally(()=>{U.value=!1})}).catch(()=>{})},le=s=>{s.preventDefault()};return _e({HomeOutlined:Le,PlusCircleOutlined:N,operateType:y,formRef:F,rowGutter:c,labelCol:W,wrapperCol:G,normalColSize:d,allRowLabelCol:O,allRowWrapperCol:T,halfRowLabelCol:g,halfRowWrapperCol:C,halfColSize:m,formState:l,risk_appetite_options:X,dateFormat:x,permissions:h,is_internet_channel_options:Z,isSubmiting:U,genderOptions:Q,permissionOptions:ee,ContactDetailTable:ne,ProductDetailTable:ue,contactRef:S,fundsRef:j,back:R,onFinish:ae,handleAnchorClick:le,handleContactDetailShow:H,handleProductTableShow:J}),(s,t)=>{const me=ye,M=Ye,be=xe,B=Ue,f=De,n=Re,u=qe,E=Fe,te=Se,P=je,ge=Pe,b=Ie,Ce=$e,he=ze,ke=Ae,we=Me;return V(),K("div",He,[_("section",Je,[_("div",null,[e(me,{level:3},{default:a(()=>[$(Ke(y.value==="add"?"新增":"编辑")+"个人客户",1)]),_:1}),e(be,{"target-offset":100,onClick:le},{default:a(()=>[e(M,{href:"#jbxx",title:"基本信息"}),y.value!=="add"?(V(),K(re,{key:0},[e(M,{href:"#lxqk",title:"联系情况"}),e(M,{href:"#jjsm",title:"基金理财/私募"})],64)):ie("",!0),e(M,{href:"#khgs",title:"客户归属"}),e(M,{href:"#rzrq",title:"融资融券"})]),_:1})]),_("div",null,[e(B,{block:"",style:{"margin-bottom":"12px"},onClick:A},{default:a(()=>[$(" 重置")]),_:1}),e(B,{block:"",type:"primary",onClick:ae},{default:a(()=>[$("完成")]),_:1}),e(B,{block:"",style:{"margin-top":"12px"},onClick:R},{default:a(()=>[$("返回")]),_:1})])]),_("main",Qe,[Xe,e(we,{spinning:U.value,tip:"正在提交..."},{default:a(()=>[e(ke,{ref_key:"formRef",ref:F,class:"ant-advanced-form",labelCol:W.value,wrapperCol:G.value,model:l},{default:a(()=>[Ze,e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"name",label:"姓  名",rules:[{required:!0,message:"请输入姓名"}]},{default:a(()=>[e(f,{value:l.name,"onUpdate:value":t[0]||(t[0]=o=>l.name=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"gender",label:"性  别",rules:[{required:!0,message:"请选择性别"}]},{default:a(()=>[e(E,{value:l.gender,"onUpdate:value":t[1]||(t[1]=o=>l.gender=o),options:Q},null,8,["value","options"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"occupation",label:"职  业",rules:[{required:!0,message:"请输入职业"}]},{default:a(()=>[e(f,{value:l.occupation,"onUpdate:value":t[2]||(t[2]=o=>l.occupation=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"phone",label:"联系方式",rules:[{required:!0,message:"请输入联系方式"}]},{default:a(()=>[e(f,{value:l.phone,"onUpdate:value":t[3]||(t[3]=o=>l.phone=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"capital_account",label:"资金账号",rules:[{required:!0,message:"请输入资金账号"}]},{default:a(()=>[e(f,{value:l.capital_account,"onUpdate:value":t[4]||(t[4]=o=>l.capital_account=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"birthday",label:"出生日期"},{default:a(()=>[e(te,{value:l.birthday,"onUpdate:value":t[5]||(t[5]=o=>l.birthday=o),placeholder:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"certificate_type",label:"证件类型"},{default:a(()=>[e(f,{value:l.certificate_type,"onUpdate:value":t[6]||(t[6]=o=>l.certificate_type=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"certificate_number",label:"证件号码"},{default:a(()=>[e(f,{value:l.certificate_number,"onUpdate:value":t[7]||(t[7]=o=>l.certificate_number=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"existing_assets",label:"现有资产"},{default:a(()=>[e(P,{style:{width:"100%"},value:l.existing_assets,"onUpdate:value":t[8]||(t[8]=o=>l.existing_assets=o)},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"historical_peak",label:"历史峰值"},{default:a(()=>[e(P,{style:{width:"100%"},value:l.historical_peak,"onUpdate:value":t[9]||(t[9]=o=>l.historical_peak=o)},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"customer_source",label:"客户来源"},{default:a(()=>[e(f,{value:l.customer_source,"onUpdate:value":t[10]||(t[10]=o=>l.customer_source=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"specific_channel",label:"具体渠道"},{default:a(()=>[e(f,{value:l.specific_channel,"onUpdate:value":t[11]||(t[11]=o=>l.specific_channel=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1})]),_:1},16),e(u,r(i(d.value)),{default:a(()=>[e(n,{name:"commission_rate",label:"佣金费率"},{default:a(()=>[e(P,{style:{width:"100%"},value:l.commission_rate,"onUpdate:value":t[12]||(t[12]=o=>l.commission_rate=o)},null,8,["value"])]),_:1})]),_:1},16),e(u,{span:24},{default:a(()=>[e(n,{labelCol:O.value,wrapperCol:T.value,name:"risk_appetite",label:"风险偏好"},{default:a(()=>[e(E,{value:l.risk_appetite,"onUpdate:value":t[13]||(t[13]=o=>l.risk_appetite=o),options:X},null,8,["value","options"])]),_:1},8,["labelCol","wrapperCol"])]),_:1}),e(u,{span:24},{default:a(()=>[e(n,{labelCol:O.value,wrapperCol:T.value,label:"权限情况"},{default:a(()=>[e(ge,{value:h.value,"onUpdate:value":t[14]||(t[14]=o=>h.value=o),options:ee},null,8,["value","options"])]),_:1},8,["labelCol","wrapperCol"])]),_:1})]),_:1},8,["gutter"]),y.value!=="add"?(V(),K(re,{key:0},[_("h3",ea,[aa,_("p",{class:"title-btn",onClick:H},[e(pe(N)),la])]),e(ne,{ref_key:"contactRef",ref:S,style:{"margin-bottom":"0.5em"},"customer-id":l.id},null,8,["customer-id"]),_("h3",ta,[oa,_("p",{class:"title-btn",onClick:J},[e(pe(N)),na])]),e(ue,{ref_key:"fundsRef",ref:j,style:{"margin-bottom":"0.5em"},"customer-id":l.id},null,8,["customer-id"])],64)):ie("",!0),ua,e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"developer",label:"开发关系"},{default:a(()=>[e(f,{value:l.developer,"onUpdate:value":t[15]||(t[15]=o=>l.developer=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"]),e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"assignmenter",label:"服务包分配"},{default:a(()=>[e(f,{value:l.assignmenter,"onUpdate:value":t[16]||(t[16]=o=>l.assignmenter=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"]),e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"follower",label:"跟进情况"},{default:a(()=>[e(f,{value:l.follower,"onUpdate:value":t[17]||(t[17]=o=>l.follower=o),valueModifiers:{trim:!0}},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"]),e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:{lg:{span:6,offset:0},xl:{span:7,offset:0},xxl:{span:5,offset:0}},wrapperCol:{lg:{span:18,offset:0},xl:{span:17,offset:0},xxl:{span:19,offset:0}},name:"is_internet_channel",label:"是否是互联网渠道"},{default:a(()=>[e(E,{value:l.is_internet_channel,"onUpdate:value":t[18]||(t[18]=o=>l.is_internet_channel=o),options:Z},null,8,["value","options"])]),_:1})]),_:1},16)]),_:1},8,["gutter"]),sa,e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"account_opening_date",label:"开户日期"},{default:a(()=>[e(te,{value:l.account_opening_date,"onUpdate:value":t[19]||(t[19]=o=>l.account_opening_date=o),placeholder:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"]),e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"preferential_interest_rate",label:"优惠利率"},{default:a(()=>[e(P,{style:{width:"100%"},value:l.preferential_interest_rate,"onUpdate:value":t[20]||(t[20]=o=>l.preferential_interest_rate=o)},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"]),e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"dateRange",label:"时  间"},{default:a(()=>[e(Ce,{style:{width:"100%"},value:v.value,"onUpdate:value":t[21]||(t[21]=o=>v.value=o),format:x},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"]),e(b,{gutter:c.value},{default:a(()=>[e(u,r(i(m.value)),{default:a(()=>[e(n,{labelCol:g.value,wrapperCol:C.value,name:"remark",label:"备  注"},{default:a(()=>[e(he,{value:l.remark,"onUpdate:value":t[22]||(t[22]=o=>l.remark=o),rows:4,"show-count":"",maxlength:100},null,8,["value"])]),_:1},8,["labelCol","wrapperCol"])]),_:1},16)]),_:1},8,["gutter"])]),_:1},8,["labelCol","wrapperCol","model"])]),_:1},8,["spinning"])])])}}},qa=Ee(ra,[["__scopeId","data-v-cbbcce4e"]]);export{qa as default};
