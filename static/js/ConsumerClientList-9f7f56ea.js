import{m as q,B as le,F as se,g as ie,I as ue,h as re,i as _e,j as ce,_ as de,k as pe,l as me,o as ve,S as fe}from"./ant-design-vue-69c5e787.js";import{e as he,l as d,r as M,K as ge,X as m,a0 as C,a1 as i,a5 as D,a6 as v,c as e,Z as n,F as P,a4 as ye,u as L,E as f,a7 as Q,B as A,a2 as ke,a3 as Ce,Y as be}from"./@vue-0057e33b.js";import{u as xe}from"./vue-router-2c461628.js";import{u as Se}from"./store-b4c7e3e8.js";import{_ as we,a as z}from"./index-a7c45ba7.js";import{S as J,G as K,P as X}from"./@ant-design-c5cfb3ae.js";import"./@babel-f2deaedd.js";import"./lodash-es-c37e40cf.js";import"./resize-observer-polyfill-2974a3e4.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-7942c886.js";import"./compute-scroll-into-view-183f845a.js";import"./dayjs-d2af4db4.js";import"./vue-types-ef06c517.js";import"./@ctrl-eebb6dbe.js";import"./dom-align-529d0cdc.js";import"./pinia-75b29db1.js";import"./nprogress-8c52ea9a.js";import"./axios-cd074bab.js";import"./form-data-d2a9677b.js";const b=h=>(ke("data-v-87b72037"),h=h(),Ce(),h),Ie={class:"statistic-panel"},$e=b(()=>i("p",null,"需联系客户",-1)),Fe=b(()=>i("p",null,"基金到期客户",-1)),De=b(()=>i("p",null,"利率失效客户",-1)),Le={class:"btn-group"},ze={key:0},Be={key:1,class:"table-operation"},Te=["onClick"],Ue=["onClick"],Oe=b(()=>i("a",{href:"#"},"删除",-1)),Re={__name:"ConsumerClientList",setup(h,{expose:Y}){const x=he("$http"),B=xe(),S=d(),a=M({customer_id:"",capital_account:"",customer_type:0,contact_person:"",assignmenter:"",name:"",phone:"",follower:"",is_internet_channel:"",margin_account:"",developer:"",remind_type:""}),T=M([{key:"否",value:0},{key:"是",value:1}]),U=()=>{S.value.resetFields(),c()},p=d({}),g=d(!1),O=d([{title:"客户ID",dataIndex:"id",minWidth:100,width:100},{title:"姓名",dataIndex:"name",minWidth:200},{title:"资金账号",dataIndex:"capital_account",responsive:["md"],minWidth:250},{title:"联系方式",dataIndex:"phone",responsive:["md"],minWidth:200},{title:"是否是互联网渠道",dataIndex:"is_internet_channel",minWidth:200},{title:"跟进情况",dataIndex:"follower",minWidth:200},{title:"操作",dataIndex:"action",fixed:"right",width:210}]),w=d([]),_=d({current:1,pageSize:10,total:0,showQuickJumper:!0,showSizeChanger:!0,showTotal:l=>`共${l}条`}),R=l=>{_.value.current=l.current,_.value.pageSize=l.pageSize,_.value.total=l.total,c()},W=Se();function I(l,t=null){l==="edit"&&W.setGrkhForm(t),B.push({path:"/home/grkhForm",query:{type:l}})}const N=(l=null)=>{W.setGrkhForm(l),B.push({path:"/home/grkhDetail"})};function y(l){a.remind_type===l?a.remind_type="":a.remind_type=l,c()}const Z=async()=>{const{data:l}=await x.get(z.customersRemind);p.value=l.individual_customer},c=()=>{g.value=!0;const l=Object.keys(a).filter(s=>a[s]!==""),t={};l.forEach(s=>{t[s]=a[s]});const u={...t,pageNo:_.value.current,pageSize:_.value.pageSize};x.get(z.customersList,{params:u}).then(s=>{const{data:r,total:k}=s;w.value=r,_.value.total=k}).finally(()=>{g.value=!1})},V=l=>{const t=q.loading("正在删除",0);x.delete(`${z.customersList}/${l.id}`).then(u=>{u.code===0&&(q.success("删除成功"),c())}).finally(()=>{t()})};return ge(()=>{Z(),c()}),Y({SearchOutlined:J,SyncOutlined:K,PlusOutlined:X,formRef:S,formState:a,isLoading:g,columns:O,dataSource:w,channelDict:T,individual_customer:p,paginationOptions:_,resetQuery:U,handleTableChange:R,filterRemindType:y,confirmDelete:V,routerToForm:I,routerToDetail:N}),(l,t)=>{const u=ue,s=re,r=_e,k=ce,H=fe,ee=de,$=le,te=se,ne=pe,j=me,ae=ve,oe=ie;return m(),C(P,null,[i("div",Ie,[i("div",{class:D(["statistic-item",{active:a.remind_type==="需要联系客户"}]),onClick:t[0]||(t[0]=o=>y("需要联系客户"))},[$e,i("p",null,v(p.value.need_to_contact_customers_count||0),1)],2),i("div",{class:D(["statistic-item",{active:a.remind_type==="基金到期客户"}]),onClick:t[1]||(t[1]=o=>y("基金到期客户"))},[Fe,i("p",null,v(p.value.fund_expiry_customers_count||0),1)],2),i("div",{class:D(["statistic-item",{active:a.remind_type==="融资融券利率到期客户"}]),onClick:t[2]||(t[2]=o=>y("融资融券利率到期客户"))},[De,i("p",null,v(p.value.interest_rate_expiry_customers_count||0),1)],2)]),e(te,{ref_key:"formRef",ref:S,name:"advanced_search",class:"ant-advanced-search-form",model:a,onFinish:c},{default:n(()=>[e(k,{gutter:24},{default:n(()=>[e(r,{span:6},{default:n(()=>[e(s,{name:"customer_id",label:"客户ID"},{default:n(()=>[e(u,{value:a.customer_id,"onUpdate:value":t[3]||(t[3]=o=>a.customer_id=o),valueModifiers:{number:!0}},null,8,["value"])]),_:1})]),_:1}),e(r,{span:6},{default:n(()=>[e(s,{name:"capital_account",label:"资金账号"},{default:n(()=>[e(u,{value:a.capital_account,"onUpdate:value":t[4]||(t[4]=o=>a.capital_account=o)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:6},{default:n(()=>[e(s,{name:"name",label:"姓  名"},{default:n(()=>[e(u,{value:a.name,"onUpdate:value":t[5]||(t[5]=o=>a.name=o)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:6},{default:n(()=>[e(s,{name:"phone",label:"联系方式"},{default:n(()=>[e(u,{value:a.phone,"onUpdate:value":t[6]||(t[6]=o=>a.phone=o)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:24},{default:n(()=>[e(r,{span:6},{default:n(()=>[e(s,{name:"is_internet_channel",label:"是否是互联网渠道"},{default:n(()=>[e(ee,{value:a.is_internet_channel,"onUpdate:value":t[7]||(t[7]=o=>a.is_internet_channel=o),placeholder:"请选择",allowClear:""},{default:n(()=>[(m(!0),C(P,null,ye(T,o=>(m(),be(H,{key:o.value,value:o.value},{default:n(()=>[f(v(o.key),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),e(r,{span:6},{default:n(()=>[e(s,{name:"developer",label:"开发关系"},{default:n(()=>[e(u,{value:a.developer,"onUpdate:value":t[8]||(t[8]=o=>a.developer=o)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:6},{default:n(()=>[e(s,{name:"follower",label:"跟进情况"},{default:n(()=>[e(u,{value:a.follower,"onUpdate:value":t[9]||(t[9]=o=>a.follower=o)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:6},{default:n(()=>[e($,{type:"primary","html-type":"submit"},{icon:n(()=>[e(L(J))]),default:n(()=>[f(" 搜索")]),_:1}),e($,{style:{margin:"0 8px"},onClick:U},{icon:n(()=>[e(L(K))]),default:n(()=>[f(" 重置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),i("div",Le,[e($,{type:"primary",onClick:t[10]||(t[10]=o=>I("add"))},{icon:n(()=>[e(L(X))]),default:n(()=>[f(" 新增")]),_:1})]),e(oe,{columns:O.value,"data-source":w.value,loading:g.value,pagination:_.value,onChange:R,scroll:{x:1500},bordered:"",class:"search-result-list","row-key":"id"},{bodyCell:n(({column:o,text:E,record:F})=>[o.dataIndex==="is_internet_channel"?(m(),C("span",ze,[e(ne,{color:E===1?"green":"red"},{default:n(()=>[f(v(E===1?"是":"否"),1)]),_:2},1032,["color"])])):Q("",!0),o.dataIndex==="action"?(m(),C("div",Be,[i("a",{onClick:A(G=>N(F),["prevent"])},"详情",8,Te),e(j,{type:"vertical"}),i("a",{onClick:A(G=>I("edit",F),["prevent"])},"编辑",8,Ue),e(j,{type:"vertical"}),e(ae,{title:"确定删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:G=>V(F)},{default:n(()=>[Oe]),_:2},1032,["onConfirm"])])):Q("",!0)]),_:1},8,["columns","data-source","loading","pagination"])],64)}}},at=we(Re,[["__scopeId","data-v-87b72037"]]);export{at as default};
